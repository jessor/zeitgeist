#content.row-fluid

  - if @items
    %div{ :class => 'items span12' }
      %ul{ :class => 'thumbnails centered' }
        - @items.each do |item|
          %li
            %div.thumbnail
              %a{ :href => (item.type=='image' ? item.image : item.source), 
                :class => (item.type=='image' ? 'fancybox-button' : 'embed fancybox.ajax'), 
                :data => { :htmltitle => item.html_title },
                :title => (item.title || item.source),
                :rel => 'fancybox-button' }
                - if item.type == 'video'
                  %img{ :src => '/images/video-overlay.png', :class => 'overlay', :alt => 'audio' }
                %img{ :src => (item.image ? item.image.thumbnail : "/images/#{item.type}.png"), 
                  :alt => (item.title || item.source),
                  :width => '200',
                  :height => '200' }

                - if logged_in?
                  .upvote
                    %form{ :action => "/upvote", :method => 'post' }
                      %input{ :type => 'hidden', :name => 'remove', :value => item_upvoted?(item) ? 'true' : 'false' }
                      %input{ :type => 'hidden', :name => 'id', :value => item.id }
                        %input{ :type => 'image', :src => "/images/upvote#{item_upvoted?(item) ? '_on' : ''}.png", :alt => 'up', :width => '16', :height => '16'}
                .item-meta
                  %ul{ :class => 'tags unstyled' }
                    %li
                      %a{ :href => '#', :class => 'label label-success togglelink' } +
                    - item.tags.each do |tag|
                      %li 
                        %a{ :href => "/filter/by/tag/#{escape tag.tagname}", :class => 'tag label label-info' }> #{h shorten(tag.tagname)}
                  %div.clear
                  %form.tag{ :action => "/update", :method => 'post', :id => "formforitem-#{item.id}", :class => 'form-search toggle' }
                    %input{ :type => 'hidden', :name => 'id', :value => "#{item.id}" }
                    %input{ :type => 'text', :name => 'add_tags', :class => 'autocomplete input-small' }
                    %input{ :type => 'hidden', :name => 'del_tags' }
                    %input.tagpush{ :type => 'submit', :value => 'tag!', :class => 'btn' }
                  - if item.dm_user_id == current_user.id or current_user.admin?
                    %form.delete{ :action => "/delete", :method => 'post' }
                      %input{ :type => 'hidden', :name => 'id', :value => "#{item.id}" }
                      %input{ :type => 'hidden', :name => 'return_to', :value => request.fullpath }
                      %input.tagpush{ :type => 'submit', :value => 'X' }

  #pagination  
    = pagination
